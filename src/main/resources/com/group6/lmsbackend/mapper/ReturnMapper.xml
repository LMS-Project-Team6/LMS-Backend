<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.group6.lmsbackend.mapper.ReturnMapper">

    <select id="findAllNotReturn" resultType="com.group6.lmsbackend.vo.LendReturn">
        SELECT
            lendIndex,
            memId,
            bookId,
            lendDate,
            returnDate,
            returnNY,
            overNY
        FROM lendreturn
        WHERE returnNY = 0
    </select>

    <update id="returnBooksByBookIds" parameterType="list">
        UPDATE lendreturn
        SET returnNY = 1,
        overNY = 0,
        returnDate = CURRENT_DATE()
        WHERE returnNY = 0
        AND bookId IN
        <foreach item="id" index="index" collection="bookIds" open="(" separator="," close=")">
            #{id}
        </foreach>

    </update>

    <!-- 도서 상태 lendNY = 0 -->
    <update id="updateBookReturnStatus" parameterType="String">
        UPDATE book
        SET lendNY = 0
        WHERE bookId = #{bookId}
    </update>

</mapper>